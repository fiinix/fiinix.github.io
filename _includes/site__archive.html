<ul class="clean-list">
{%for post in site.posts %}
{% capture year %}{{ post.date | date: '%Y' }}{% endcapture %}
{% if year == include.year  %}
<!-- <li> -->
{% unless post.next %}
<!-- <ul class="this"> -->
<li class="current-month"><h2 id="{{ post.date | date: '%B' | downcase }}" class="h5 subheading archive-subheading">{{ post.date | date: '%B' }}</h2>
<ul class="clean-list">
{% else %}
<!-- {% capture year %}{{ post.date | date: '%Y' }}{% endcapture %} -->
<!-- {% capture nyear %}{{ post.next.date | date: '%Y' }}{% endcapture %} -->
{% capture month %}{{ post.date | date: '%B' }}{% endcapture %}
{% capture nmonth %}{{ post.next.date | date: '%B' }}{% endcapture %}
<!-- New month -->
{% if month != nmonth %}
<!-- </ul> -->
<li class="previous-month"><h2 id="{{ post.date | date: '%B' | downcase }}" class="h5 subheading archive-subheading">{{ post.date | date: '%B' }}</h2>
<ul class="clean-list">
<!-- <ul> -->
<!-- <ul class="past"> -->
{% endif %}
<!-- / New month -->
{% endunless %}
<li class="post">{% if post.color %}{% endif %}<h3 class="h4"><a href="{{ post.url }}">{{ post.title | markdownify | strip_html | trim  }}</a></h3></li>

{% unless post.next %}
<!-- </ul> -->
{% else %}
{% capture month %}{{ post.date | date: '%B' }}{% endcapture %}
{% capture pmonth %}{{ post.previous.date | date: '%B' }}{% endcapture %}
<!-- New month -->
{% if month != pmonth %}
</ul></li>
{% endif %}
<!-- / New month -->
{% endunless %}
{% endif %}
{% endfor %}
</ul>